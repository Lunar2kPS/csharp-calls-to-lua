version: 2.1

orbs:
    win: circleci/windows@2.2.0

jobs:
    build:
        executor: win/default

        steps:
          - checkout
          # NOTE: These 2 run steps were given by https://circleci.com/docs/2.0/docker-compose/
          # This allows us to use the docker-compose command!
          - run:
              name: Install Docker Compose
              command: |
                  curl -L https://github.com/docker/compose/releases/download/1.27.4/docker-compose-`uname -s`-`uname -m` > ~/docker-compose
                  chmod +x ~/docker-compose
                  sudo mv ~/docker-compose /usr/local/bin/docker-compose
          - setup_remote_docker:
              docker_layer_caching: false

          - run:
              name: Build Docker Image
              command: docker build -t 2kcarlos/csharp-calls-to-lua .
          - run:
              name: Run Docker Container(s)
              command: docker-compose up
